CREATE TABLE automatic_payment_risk_signals
(
    reference_id                    SERIAL PRIMARY KEY UNIQUE NOT NULL,
    recurring_payment_id            text UNIQUE,
    payment_reference_id            integer,
    device_id                       varchar,
    rooted_device                   boolean,
    screen_brightness               double precision,
    elapsed_time_since_boot         integer,
    os_version                      varchar,
    user_time_zone_offset           varchar,
    language                        varchar,
    screen_dimensions_height        integer,
    screen_dimensions_width         integer,
    account_tenure                  date,
    geolocation_latitude            double precision,
    geolocation_longitude           double precision,
    geolocation_type                varchar,
    call_in_progress                boolean,
    dev_mode_enabled                boolean,
    mock_gps                        boolean,
    emulated                        boolean,
    monkey_runner                   boolean,
    charging                        boolean,
    antenna_information             varchar,
    usb_connected                   boolean,
    integrity_app_recognition_verdict varchar,
    integrity_device_recognition_verdict varchar,
    last_login_date_time            date,
    pix_key_registration_date_time  date,
    created_at                      date,
    created_by                      varchar(20),
    updated_at                      date,
    updated_by                      varchar(20),
    hibernate_status                varchar,
    FOREIGN KEY (payment_reference_id) REFERENCES pix_payments (reference_id) ON DELETE CASCADE
);

CREATE TABLE automatic_payment_risk_signals_aud
(
    reference_id                    integer,
    recurring_payment_id            text,
    payment_reference_id            integer,
    device_id                       varchar,
    rooted_device                   boolean,
    screen_brightness               double precision,
    elapsed_time_since_boot         integer,
    os_version                      varchar,
    user_time_zone_offset           varchar,
    language                        varchar,
    screen_dimensions_height        integer,
    screen_dimensions_width         integer,
    account_tenure                  date,
    geolocation_latitude            double precision,
    geolocation_longitude           double precision,
    geolocation_type                varchar,
    call_in_progress                boolean,
    dev_mode_enabled                boolean,
    mock_gps                        boolean,
    emulated                        boolean,
    monkey_runner                   boolean,
    charging                        boolean,
    antenna_information             varchar,
    usb_connected                   boolean,
    integrity_app_recognition_verdict varchar,
    integrity_device_recognition_verdict varchar,
    last_login_date_time            date,
    pix_key_registration_date_time  date,
    created_at                      date,
    created_by                      varchar(20),
    updated_at                      date,
    updated_by                      varchar(20),
    hibernate_status                varchar,
    rev                                     integer NOT NULL,
    revtype                                 smallint,
    PRIMARY KEY (reference_id, rev),
    FOREIGN KEY (rev) REFERENCES revinfo (rev)
);

ALTER TABLE pix_payments
    ADD COLUMN date date;

ALTER TABLE pix_payments_aud
    ADD COLUMN date date;